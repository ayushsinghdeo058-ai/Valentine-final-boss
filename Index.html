<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Our Eternal Story</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600;700&family=Quicksand:wght@300;500;700&family=Great+Vibes&display=swap" rel="stylesheet">
    <style>
        :root {
            --rose: #ff4d6d;
            --crimson: #c9184a;
            --glass: rgba(255, 255, 255, 0.12);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            margin: 0; padding: 0; font-family: 'Quicksand', sans-serif;
            background: radial-gradient(circle at center, #2b0d12 0%, #120507 100%);
            height: 100vh; overflow: hidden; color: #fff0f3;
        }

        #petal-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }

        /* --- SCREEN SYSTEM --- */
        .screen {
            position: absolute; width: 100%; height: 100%;
            display: none; flex-direction: column; align-items: center;
            justify-content: center; text-align: center; padding: 25px; z-index: 10;
        }
        .active-screen { display: flex; animation: smoothIn 1.2s ease-out forwards; }
        @keyframes smoothIn { 0% { opacity: 0; transform: scale(0.98); } 100% { opacity: 1; transform: scale(1); } }

        .glass-card {
            background: var(--glass); backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 77, 109, 0.3);
            border-radius: 40px; padding: 40px 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            max-width: 400px; width: 95%;
        }

        .btn {
            background: linear-gradient(45deg, var(--rose), var(--crimson));
            color: white; border: none; padding: 14px 35px;
            font-family: 'Dancing Script', cursive; font-size: 1.4rem;
            cursor: pointer; border-radius: 50px; transition: 0.3s; margin: 10px;
            box-shadow: 0 5px 15px rgba(201, 24, 74, 0.4);
        }
        .btn-back { background: transparent; border: 1px solid var(--rose); color: var(--rose); font-size: 1.1rem; }

        /* --- HEART BOXES --- */
        .gift-row { display: flex; gap: 12px; }
        .heart-box { width: 90px; height: 90px; cursor: pointer; position: relative; transform-style: preserve-3d; transition: 0.8s; }
        .heart-box.flipped { transform: rotateY(180deg); }
        .face { position: absolute; width: 100%; height: 100%; border-radius: 20px; display: flex; align-items: center; justify-content: center; backface-visibility: hidden; border: 1px solid var(--rose); }
        .face-front { background: rgba(255,255,255,0.05); font-size: 2.5rem; }
        .face-back { background: var(--rose); transform: rotateY(180deg); color: white; font-family: 'Dancing Script'; font-size: 1.1rem; }

        /* --- PHOTO STYLING --- */
        .memory-node {
            position: relative; width: 260px; background: white;
            padding: 12px 12px 45px 12px; border-radius: 2px;
            margin: 60px 0; z-index: 10;
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
        }
        .memory-node img { width: 100%; height: auto; display: block; filter: sepia(0.2); }
        .memory-node p { font-family: 'Dancing Script'; font-size: 1.4rem; margin: 15px 0 0 0; color: #333; font-weight: bold; }
        
        /* --- FINAL JOURNEY SCROLL --- */
        .scroll-area { 
            overflow-y: auto; scroll-behavior: smooth; 
            justify-content: flex-start !important; padding-top: 100px;
        }
        .scroll-area::-webkit-scrollbar { display: none; }
        
        .rope-svg { position: absolute; top: 0; left: 0; width: 100%; height: 3500px; pointer-events: none; z-index: 5; }
        .rope-path {
            stroke: var(--rose); stroke-width: 5; fill: none;
            filter: drop-shadow(0 0 8px var(--rose));
            stroke-linecap: round;
        }

        .node-left { align-self: flex-start; margin-left: 20px; transform: rotate(-6deg); }
        .node-right { align-self: flex-end; margin-right: 20px; transform: rotate(6deg); }
        .node-center { align-self: center; transform: rotate(-2deg); }
    </style>
</head>
<body onclick="playClickSound()">

    <canvas id="petal-canvas"></canvas>
    
    <audio id="music1" loop><source src="SONG_1"></audio>
    <audio id="music2" loop><source src="SONG_2"></audio>
    <audio id="sfx-click"><source src="CLICK_SOUND"></audio>
    <audio id="sfx-flip"><source src="FLIP_SOUND"></audio>

    <div id="screen-1" class="screen active-screen">
        <div class="glass-card">
            <img src="MAIN_VALENTINE_STICKER" style="width:110px; margin-bottom:10px;">
            <h1 style="font-family:'Great Vibes';">Hi Cutie pie,</h1>
            <p>I have a special journey for you...</p>
            <button class="btn" onclick="start()">Begin Journey ‚ù§Ô∏è</button>
            <button class="btn btn-back" onclick="nextScreen(2)">No</button>
        </div>
    </div>

    <div id="screen-2" class="screen">
        <div class="glass-card">
            <img src="HUMPH_CAT" style="width:100px;">
            <p>Wait, my heart would break! <br>Are you sure? ü•∫</p>
            <button class="btn" onclick="nextScreen(1)">Go Back</button>
            <button class="btn btn-back" onclick="nextScreen(3)">Stay No</button>
        </div>
    </div>

    <div id="screen-3" class="screen">
        <div class="glass-card">
            <img src="ANGRY_CAT" style="width:100px;">
            <h1 style="font-size:2.5rem;">Unlock the Secret</h1>
            <input type="text" id="flower" placeholder="My favorite flower?" style="background:none; border:none; border-bottom:2px solid var(--rose); color:white; text-align:center; padding:10px; width:85%; outline:none; font-size:1.2rem; margin:20px 0;">
            <button class="btn" onclick="check()">Validate</button>
            <button id="sorry" class="btn btn-back" disabled style="opacity:0.2" onclick="nextScreen(1)">I'm Sorry ü•∫</button>
        </div>
    </div>

    <div id="screen-4" class="screen">
        <h1 style="margin-bottom:50px; font-family:'Great Vibes'; font-size:3.5rem;">Memory Vault üíù</h1>
        <div class="gift-row">
            <div class="heart-box" id="hb1" onclick="boxLogic(1)"><div class="face face-front">üéÅ</div><div class="face face-back">LOVE</div></div>
            <div class="heart-box" id="hb2" onclick="boxLogic(2)"><div class="face face-front">üéÅ</div><div class="face face-back">US</div></div>
            <div class="heart-box" id="hb3" onclick="boxLogic(3)"><div class="face face-front">üéÅ</div><div class="face face-back">MORE</div></div>
        </div>
        <p style="margin-top:30px; font-family:'Dancing Script'; font-size:1.3rem;">Open each one carefully...</p>
    </div>

    <div id="screen-5" class="screen">
        <div class="memory-node" style="transform:rotate(-5deg);"><img src="PHOTO_1"><p>My Favorite View.</p></div>
        <button class="btn btn-back" onclick="nextScreen(4)">Back to Vault</button>
    </div>

    <div id="screen-6" class="screen">
        <div class="memory-node" style="transform:rotate(5deg);"><img src="PHOTO_2"><p>Cherished Moment.</p></div>
        <button class="btn btn-back" onclick="nextScreen(4)">Back to Vault</button>
    </div>

    <div id="screen-7" class="screen">
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-bottom: 25px;">
            <div class="heart-box" style="width:137px;" onclick="this.classList.toggle('flipped'); playFlipSound();"><div class="face face-front">?</div><div class="face face-back">You Are Always Mine</div></div>
            <div class="heart-box" style="width:137px;" onclick="this.classList.toggle('flipped'); playFlipSound();"><div class="face face-front">?</div><div class="face face-back">Forever Together</div></div>
            <div class="heart-box" style="width:137px;" onclick="this.classList.toggle('flipped'); playFlipSound();"><div class="face face-front">?</div><div class="face face-back">I Yours</div></div>
            <div class="heart-box" style="width:137px;" onclick="this.classList.toggle('flipped'); playFlipSound();"><div class="face face-front">?</div><div class="face face-back">Soulmate For Eternal</div></div>
        </div>
        <div style="display:flex; flex-direction:column; gap:5px;">
            <button class="btn btn-back" onclick="nextScreen(4)">Go Back</button>
            <button class="btn" onclick="goFinale()">Final Journey ‚ù§Ô∏è</button>
        </div>
    </div>

    <div id="screen-8" class="screen scroll-area">
        <svg class="rope-svg"><path id="ropePath" class="rope-path" d=""/></svg>
        <div class="memory-node node-left"><img src="M1"><p>Where We Started</p></div>
        <div class="memory-node node-right"><img src="M2"><p>Our First Laugh</p></div>
        <div class="memory-node node-left"><img src="M3"><p>Through Everything</p></div>
        <div class="memory-node node-right"><img src="M4"><p>Our Beautiful Forever</p></div>
        
        <h2 style="font-family:'Great Vibes'; font-size:3.8rem; color:var(--rose); margin:60px 0;">I Love You, Forever.</h2>
        <button class="btn" onclick="location.reload()" style="margin-bottom:100px;">Relive the Story</button>
    </div>

    <script>
        const sfxClick = document.getElementById('sfx-click');
        const sfxFlip = document.getElementById('sfx-flip');
        function playClickSound() { sfxClick.play(); }
        function playFlipSound() { sfxFlip.play(); }

        // --- PETALS ENGINE ---
        const canvas = document.getElementById('petal-canvas');
        const ctx = canvas.getContext('2d');
        let petals = [];
        function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resize); resize();
        class Petal {
            constructor() { this.x=Math.random()*canvas.width; this.y=Math.random()*canvas.height; this.s=Math.random()*1+0.5; this.r=Math.random()*2+1; }
            draw() { ctx.fillStyle="rgba(255, 77, 109, 0.35)"; ctx.beginPath(); ctx.arc(this.x, this.y, this.r, 0, Math.PI*2); ctx.fill(); this.y+=this.s; if(this.y>canvas.height) this.y=-5; }
        }
        for(let i=0; i<60; i++) petals.push(new Petal());
        function anim() { ctx.clearRect(0,0,canvas.width, canvas.height); petals.forEach(p=>p.draw()); requestAnimationFrame(anim); }
        anim();

        // --- NAVIGATION ---
        function nextScreen(n) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
            document.getElementById('screen-'+n).classList.add('active-screen');
        }
        function start() { document.getElementById('music1').play(); nextScreen(4); }
        function check() { if(document.getElementById('flower').value.toLowerCase()==="tulip") { document.getElementById('sorry').disabled=false; document.getElementById('sorry').style.opacity=1; } }
        
        function boxLogic(n) {
            const b = document.getElementById('hb'+n);
            if(!b.classList.contains('flipped')) { playFlipSound(); b.classList.add('flipped'); }
            else nextScreen(n+4);
        }

        // --- ROPE ENGINE (Immediate Draw) ---
        function goFinale() {
            document.getElementById('music1').pause();
            document.getElementById('music2').play();
            nextScreen(8);
            // Delay slightly to ensure screen is active before calculating positions
            setTimeout(drawEternalRope, 200);
        }

        function drawEternalRope() {
            const nodes = document.querySelectorAll('.scroll-area .memory-node');
            const ropePath = document.getElementById('ropePath');
            let d = "";
            
            nodes.forEach((node, i) => {
                const x = node.offsetLeft + (node.offsetWidth / 2);
                const y = node.offsetTop + (node.offsetHeight / 2);
                
                if(i === 0) {
                    d += `M ${x} ${y}`;
                } else {
                    const px = nodes[i-1].offsetLeft + (nodes[i-1].offsetWidth / 2);
                    const py = nodes[i-1].offsetTop + (nodes[i-1].offsetHeight / 2);
                    // Create a smooth curve between tilted photos
                    const cpY = py + (y - py) / 2;
                    d += ` C ${px} ${cpY}, ${x} ${cpY}, ${x} ${y}`;
                }
            });
            
            ropePath.setAttribute('d', d);
        }
    </script>
</body>
</html>
